---
title: 'ğŸ‘‰ 15 i18n å›½é™…åŒ–ä¸æœ¬åœ°åŒ–'
excerpt: 'Next.js 10 é¡¹ç›®çš„å›½é™…åŒ–è°ƒæ•´åˆ†ä¸ºä¸¤å—ï¼šç¿»è¯‘ï¼Œä¸è·¯ç”±ï¼Œæ”¯æŒä¸¤ç§æœ€å¸¸è§çš„è·¯ç”±ç­–ç•¥ï¼šå­è·¯å¾„è·¯ç”±ï¼Œä¸åŸŸè·¯ç”±ã€‚å¯¹äºè¿™ä¸¤ç§ç­–ç•¥ï¼Œéƒ½éœ€è¦å…ˆåœ¨ Next.js é…ç½®ä¸­æŒ‡å®šè¯­è¨€ç¯å¢ƒã€‚'
coverImage: '/20161106s.jpg'
date: '2021-02-04T22:40:07.322Z'
author:
    name: Jeango
    picture: '/jeango.jpg'
ogImage:
    url: '/20161106s.jpg'
---

# ğŸ‘‰ i18n-routing å›½é™…åŒ–è·¯ç”±
- https://nextjs.org/docs/advanced-features/i18n-routing
- https://www.unicode.org/reports/tr35/tr35-59/tr35.html#Identifiers

é…ç½®åŒºåŸŸä¿¡æ¯ï¼š

```js
// ğŸ‘‰ /next.config.js é…ç½®è„šæœ¬
module.exports = {
  i18n: {
    // These are all the locales you want to support in
    // your application
    locales: ['en-US', 'fr', 'nl-NL'],
    // This is the default locale you want to be used when visiting
    // a non-locale prefixed path e.g. `/hello`
    defaultLocale: 'en-US',
    // This is a list of locale domains and the default locale they
    // should handle (these are only required when setting up domain routing)

	// The automatic locale detection can be disabled with:
    localeDetection: false,

    domains: [
      {
        domain: 'example.com',
        defaultLocale: 'en-US',
      },
      {
        domain: 'example.nl',
        defaultLocale: 'nl-NL',
      },
      {
        domain: 'example.fr',
        defaultLocale: 'fr',
      },
    ],
  },
}
```

Next.js 10 é¡¹ç›®çš„å›½é™…åŒ–è°ƒæ•´åˆ†ä¸ºä¸¤å—ï¼šç¿»è¯‘ï¼Œä¸è·¯ç”±ï¼Œæ”¯æŒä¸¤ç§æœ€å¸¸è§çš„è·¯ç”±ç­–ç•¥ï¼šå­è·¯å¾„è·¯ç”±ï¼Œä¸åŸŸè·¯ç”±ã€‚å¯¹äºè¿™ä¸¤ç§ç­–ç•¥ï¼Œéƒ½éœ€è¦å…ˆåœ¨ Next.js é…ç½®ä¸­æŒ‡å®šè¯­è¨€ç¯å¢ƒã€‚

- Sub-path Routing å­è·¯ç”±å°†åŒºåŸŸä¿¡æ¯æ”¾åœ¨ URL è·¯å¾„ä¸­ï¼Œåœ¨ `locales` æŒ‡å®šæƒ³è¦æ”¯æŒçš„æ‰€æœ‰è¯­è¨€åŒºåŸŸï¼Œåœ¨`defaultLocale`æŒ‡å®šé»˜è®¤çš„è¯­è¨€åŒºåŸŸã€‚
- Domain Routing åŸŸåè·¯ç”±

å¤§éƒ¨åˆ† React éƒ½æä¾›ç¿»è¯‘å®Œæˆçš„åº”ç”¨ç¨‹åºï¼Œä½†å´å¾ˆå°‘ä¸ºæ‚¨æä¾›è‡ªåŠ¨è·¯ç”±å¤„ç†æ–¹æ¡ˆï¼Œè€Œä¸”é€šå¸¸åªä½¿ç”¨ä¸€ç§æ¸²æŸ“ç­–ç•¥ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç°å®ï¼Œåœ¨ Next.js 10 ä¸­å‘å¸ƒå¯¹å›½é™…åŒ–è·¯ç”±ä»¥åŠè¯­è¨€æ£€æµ‹çš„å†…ç½®æ”¯æŒã€‚

å†…ç½®çš„å›½é™…åŒ–è·¯ç”±åŠŸèƒ½æ”¯æŒ Next.js çš„æ··åˆç­–ç•¥ï¼Œæ‚¨å¯ä»¥åœ¨é™æ€ç”Ÿæˆä¸æœåŠ¡å™¨æ¸²æŸ“ä¹‹é—´è‡ªç”±åšå‡ºé€‰æ‹©ã€‚

Locales ä»£è¡¨çš„æ˜¯ UTS è¯­è¨€ç¯å¢ƒæ ‡è¯†ç¬¦ï¼Œå±äºä¸€ç§ç”¨äºå®šä¹‰è¯­è¨€ç¯å¢ƒçš„æ ‡å‡†åŒ–æ ¼å¼ã€‚é€šå¸¸ï¼ŒLocale æ ‡è¯†ç¬¦ç”±è¯­è¨€ã€åŒºåŸŸä¸è„šæœ¬ç»„æˆï¼Œå„å…ƒç´ ä¹‹é—´ä½¿ç”¨ç ´æŠ˜å·åˆ†éš”`language - area - script`ï¼Œå…¶ä¸­çš„åŒºåŸŸä¸è„šæœ¬å±äºå¯é€‰é¡¹ã€‚

ä¾‹å¦‚ï¼š

- en-US - åœ¨ç¾å›½ä½¿ç”¨çš„è‹±è¯­
- nl-NL - åœ¨è·å…°ä½¿ç”¨çš„è·å…°è¯­
- nl    - æ— ç‰¹å®šä½¿ç”¨åŒºåŸŸçš„è·å…°è¯­

ä»¥ä¸Šç»™å®šçš„åŒºåŸŸä¿¡æ¯é…ç½®ä¸­ï¼Œæœ‰ä¸‰ç§è¯­è¨€ï¼Œå…¶ä¸­æ³•è¯­ fr æ²¡æœ‰æŒ‡å®šåŒºåŸŸä¿¡æ¯ï¼Œå¯¹äº `pages/blog.js` é¡µé¢æ¥è¯´ï¼Œæœ‰æ•ˆçš„è®¿é—®åœ°å€å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ä¸ªï¼š

- /blog
- /fr/blog
- /nl-nl/blog

å¯¹äºé»˜è®¤è¯­è¨€åŒºåŸŸï¼Œ`defaultLocale`çš„å€¼ä¸ä¼šåœ¨åœ°å€ä¸­å‰ç¼€ã€‚

åŸŸè·¯ç”±æ„å‘³ç€æ‚¨å°†è¯­è¨€ç¯å¢ƒä¸é¡¶çº§åŸŸåæ˜ å°„èµ·æ¥ï¼Œä¾‹å¦‚ï¼Œexample.nl å¯æ˜ å°„è‡³ nl è¯­è¨€ç¯å¢ƒï¼Œexample.com åˆ™æ˜ å°„è‡³ en è¯­è¨€ç¯å¢ƒã€‚å¯¹äº `pages/blog.js` é¡µé¢ï¼Œä»¥ä¸‹çš„åŸŸè·¯ç”±æœ‰æ•ˆï¼š

- example.com/blog
- example.fr/blog
- example.nl/blog
- example.nl/nl-BE/blog


Next.js 10 è¿›è¡Œè¯­è¨€æ£€æµ‹ï¼Œåœ¨ / è·¯ç”±ä¸Šæä¾›åŸºäº Accept-Language æ ‡å¤´çš„å†…ç½®è¯­è¨€æ£€æµ‹åŠŸèƒ½ï¼Œç›®å‰æ‰€æœ‰ç°ä»£æµè§ˆå™¨å‡æ”¯æŒæ­¤é¡¹æ£€æµ‹ã€‚é…ç½®çš„è¯­è¨€ç¯å¢ƒå°†ä¸ Accept-Language æ ‡å¤´ç›¸åŒ¹é…ï¼Œè€Œåæ ¹æ®é¢„è®¾ç­–ç•¥è¿›è¡Œé‡æ–°å®šå‘ã€‚

é€šè¿‡ Next.js Router è®¿é—®è¯­è¨€åŒºåŸŸä¿¡æ¯ï¼Œ`useRouter()` å‹¾å­å‡½æ•°è¿”å›çš„å®ä¾‹åŒ…å«ï¼š

- **locale** å½“å‰æ´»åŠ¨çš„åŒºåŸŸè¯­è¨€ï¼›
- **locales** å·²é…ç½®çš„åŒºåŸŸè¯­è¨€ï¼›
- **defaultLocale** å·²é…ç½®çš„é»˜è®¤åŒºåŸŸè¯­è¨€ï¼›

å½“è¿›è¡Œé™æ€é¢„æ¸²æŸ“æ—¶ï¼Œé¡µé¢çš„ `getStaticProps()` æˆ–è€… `getServerSideProps()` æ–¹æ³•å¯ä»¥ä»å‚æ•°ä¸­è·å–ã€‚


é€šè¿‡ `next/link` å’Œ `next/router` ç»„ä»¶å¯ä»¥å®ç°åœ¨å„ç§è¯­è¨€é—´åˆ‡æ¢ï¼Œåœ¨ Link ä¸­æŒ‡å®š `locale`ï¼š

```ts
import Link from 'next/link'

export default function IndexPage(props) {
  return (
    <Link href="/another" locale="fr">
      <a>To /fr/another</a>
    </Link>
  )
}
```

æˆ–è€…ç›´æ¥ä½¿ç”¨ `next/router` æ–¹æ³•åˆ‡æ¢ï¼Œå°†åŒºåŸŸè¯­è¨€ä¿¡æ¯è®¾ç½®åˆ°è·¯ç”±ä¸­ï¼š

```ts
import { useRouter } from 'next/router'

export default function IndexPage(props) {
  const router = useRouter()

  return (
    <div
      onClick={() => {
        router.push('/another', '/another', { locale: 'fr' })
      }}
    >
      to /fr/another
    </div>
  )
}
```

å†å¦‚ï¼Œç›´æ¥å†™å…¥ `href` å±æ€§ï¼š

```ts
import Link from 'next/link'

export default function IndexPage(props) {
  return (
    <Link href="/fr/another" locale={false}>
      <a>To /fr/another</a>
    </Link>
  )
}
```

å¯¹äºéåŠ¨æ€é¡µé¢ Non-dynamic getStaticProps Pagesï¼Œåªéœ€è¦ä¸€ä¸ªé¡µé¢å°±å¯ä»¥å¯¹åº”å·²é…ç½®çš„å„ç§è¯­è¨€ï¼Œå¦‚æœä¸æƒ³è¦å¯¹æŸç§è¯­è¨€è¿›è¡Œé¢„æ¸²æŸ“ï¼Œå¯ä»¥è¿”å› notFoundï¼š

```ts
export async function getStaticProps({ locale }) {
  // Call an external API endpoint to get posts.
  // You can use any data fetching library
  const res = await fetch(`https://.../posts?locale=${locale}`)
  const posts = await res.json()

  if (posts.length === 0) {
    return {
      notFound: true,
    }
  }

  // By returning { props: posts }, the Blog component
  // will receive `posts` as a prop at build time
  return {
    props: {
      posts,
    },
  }
}
```

å¯¹äºåŠ¨æ€é¡µé¢ Dynamic getStaticProps Pagesï¼Œéœ€è¦æ¸²æŸ“å¯¹åº”è¯­è¨€çš„é¡µé¢ï¼Œå°±è¦åœ¨è¿”å›çš„è·¯å¾„åˆ—è¡¨ä¸­è®¾ç½® `locale` å‚æ•°ã€‚

```ts
// pages/blog/[slug].js
export const getStaticPaths = ({ locales }) => {
  return {
    paths: [
      { params: { slug: 'post-1' }, locale: 'en-US' },
      { params: { slug: 'post-1' }, locale: 'fr' },
    ],
    fallback: true,
  }
}
```


æœç´¢å¼•æ“ä¼˜åŒ–
Next.js èƒ½å¤Ÿæ„ŸçŸ¥ç”¨æˆ·æ‰€è®¿é—®é¡µé¢çš„è¯­è¨€ç±»åˆ«ï¼Œå› æ­¤ä¼šè‡ªåŠ¨å°† lang å±æ€§æ·»åŠ è‡³æ ‡ç­¾å½“ä¸­ã€‚

ä½† Next.js æ— æ³•è¯†åˆ«å‡ºé¡µé¢çš„å˜ä½“ï¼Œå› æ­¤éœ€è¦ç”±æ‚¨ä½¿ç”¨ next/head æ·»åŠ  hreflang å…ƒæ ‡ç­¾ã€‚å…³äº hreflang å…ƒæ ‡ç­¾çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… è°·æ­Œ Webmasters è¯´æ˜æ–‡æ¡£ã€‚

Next.js è¿˜å°†æä¾›æ›´å¤šå›½é™…åŒ–é€‰é¡¹
å›½é™…åŒ–è·¯ç”±åªæ˜¯ Next.js ä¸€ç³»åˆ—å›½é™…åŒ–åŠŸèƒ½ä¸­çš„ä¸€ç§ï¼Œæ—¨åœ¨é™ä½é¡¹ç›®å›½é™…åŒ–ä¸æœ¬åœ°åŒ–çš„å®ç°éš¾åº¦ã€‚å›½é™…åŒ–è·¯ç”±èƒ½å¤Ÿä¸å¤§éƒ¨åˆ† React å›½é™…åŒ–åº“ç›¸é›†æˆã€‚
